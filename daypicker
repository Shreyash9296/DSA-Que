function DateFilter({ label, value, onChange, isOpen, onToggle }) {

  const reset    = () => onChange({ from: undefined, to: undefined });
  const hasValue = !!(value?.from || value?.to);

  /* Short dates for the toggle button */
  const shortDate = (d) =>
    d.toLocaleDateString("en-US", { month: "2-digit", day: "2-digit" });

  /* Long dates for the chip inside the modal */
  const longDate = (d) =>
    d.toLocaleDateString("en-US", { month: "short", day: "numeric", year: "numeric" });

  const btnSummary =
    hasValue && value.from && value.to
      ? `${shortDate(value.from)} â€“ ${shortDate(value.to)}`
      : "Select range";

  const chipSummary =
    value?.from && value?.to
      ? `${longDate(value.from)} â€“ ${longDate(value.to)}`
      : null;

  /* Close on Escape */
  useEffect(() => {
    if (!isOpen) return;
    const handler = (e) => { if (e.key === "Escape") onToggle(); };
    document.addEventListener("keydown", handler);
    return () => document.removeEventListener("keydown", handler);
  }, [isOpen, onToggle]);

  return (
    <>
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          Toggle button
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <button
        type="button"
        onClick={onToggle}
        aria-expanded={isOpen}
        aria-haspopup="dialog"
        className={[
          "inline-flex items-center gap-1.5 h-8 px-3 rounded-md border-[1.5px]",
          "bg-white text-sm font-medium transition-all duration-150 whitespace-nowrap cursor-pointer",
          isOpen
            ? "border-red-600 ring-2 ring-red-100"
            : "border-gray-300 hover:border-gray-400",
        ].join(" ")}
      >
        {/* Label text */}
        <span className="text-xs font-semibold text-gray-700">{label}</span>

        {/* Separator */}
        <span className="text-gray-300 text-xs">Â·</span>

        {/* Date value or placeholder */}
        <span
          className={`text-xs ${
            hasValue ? "text-red-800 font-bold" : "text-gray-400 font-normal"
          }`}
        >
          {btnSummary}
        </span>

        {/* Inline clear âœ• (only when a range is selected) */}
        {hasValue && (
          <span
            role="button"
            tabIndex={0}
            onClick={(e) => { e.stopPropagation(); reset(); }}
            onKeyDown={(e) => {
              if (e.key === "Enter") { e.stopPropagation(); reset(); }
            }}
            aria-label={`Clear ${label}`}
            className="text-gray-400 hover:text-red-600 transition-colors cursor-pointer text-xs leading-none"
          >
            âœ•
          </span>
        )}

        {/* Chevron arrow */}
        <svg
          className={[
            "w-3.5 h-3.5 text-gray-400 flex-shrink-0 transition-transform duration-200",
            isOpen ? "rotate-180" : "",
          ].join(" ")}
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth={2.5}
          strokeLinecap="round"
        >
          <path d="M6 9l6 6 6-6" />
        </svg>
      </button>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          Modal (backdrop + card)
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {isOpen && (
        <>
          {/* Backdrop â€“ click to close */}
          <div
            onClick={onToggle}
            aria-hidden="true"
            className="fixed inset-0 z-40 bg-black/[0.22] backdrop-blur-[2px]"
            style={{ animation: "dfBackdrop .15s ease" }}
          />

          {/* Centred card */}
          <div
            role="dialog"
            aria-modal="true"
            aria-label={`${label} date picker`}
            className={[
              "fixed z-50 bg-white rounded-2xl border border-gray-200 p-5",
              "w-[380px] max-w-[95vw]",
              // Tailwind doesn't expose translate(âˆ’50%,âˆ’50%) as a utility for fixed centering,
              // so we set top/left via inline style once and keep everything else Tailwind.
            ].join(" ")}
            style={{
              top: "50%",
              left: "50%",
              transform: "translate(-50%, -50%)",
              boxShadow: "0 24px 64px rgba(0,0,0,0.16), 0 4px 16px rgba(0,0,0,0.08)",
              animation: "dfModal .18s cubic-bezier(.34,1.2,.64,1)",
            }}
          >
            {/* â”€â”€ Card header â”€â”€ */}
            <div className="flex items-start justify-between mb-4">
              <div>
                <p className="text-[10px] font-bold uppercase tracking-widest text-gray-400 mb-0.5">
                  Date Range
                </p>
                <h3 className="text-sm font-bold text-gray-900">{label}</h3>
              </div>

              <div className="flex items-center gap-2">
                {/* Reset link (visible only when a range is selected) */}
                {hasValue && (
                  <button
                    type="button"
                    onClick={reset}
                    className="text-xs font-semibold text-red-600 hover:text-red-800
                               transition-colors bg-transparent border-0 cursor-pointer px-1 py-0.5"
                  >
                    Reset
                  </button>
                )}

                {/* Close âœ• */}
                <button
                  type="button"
                  onClick={onToggle}
                  aria-label="Close calendar"
                  className="w-7 h-7 flex items-center justify-center rounded-lg text-sm
                             bg-gray-100 hover:bg-gray-200 text-gray-500 hover:text-gray-700
                             transition-all border-0 cursor-pointer"
                >
                  âœ•
                </button>
              </div>
            </div>

            {/* â”€â”€ Range summary chip (shown when both dates selected) â”€â”€ */}
            {chipSummary && (
              <div className="flex items-center gap-2 px-3 py-2 rounded-lg
                              bg-red-50 border border-red-200 mb-4">
                <span className="text-sm">ğŸ“…</span>
                <span className="text-xs font-semibold text-red-800">{chipSummary}</span>
              </div>
            )}

            {/* â”€â”€ Calendar grid â”€â”€ */}
            <CalendarGrid value={value} onChange={onChange} />

            {/* â”€â”€ Apply / Done button â”€â”€ */}
            <button
              type="button"
              onClick={() => { if (value?.from && value?.to) onToggle(); }}
              disabled={!value?.from || !value?.to}
              className={[
                "mt-4 w-full py-2.5 rounded-xl border-0 text-sm font-bold",
                "transition-all duration-150",
                value?.from && value?.to
                  ? "bg-red-600 hover:bg-red-800 text-white cursor-pointer shadow-md shadow-red-200"
                  : "bg-gray-100 text-gray-400 cursor-not-allowed",
              ].join(" ")}
            >
              {value?.from && value?.to
                ? "âœ“  Apply Filter"
                : "Select start and end date"}
            </button>
          </div>
        </>
      )}

      {/* â”€â”€ Keyframes injected once â”€â”€ */}
      <style>{`
        @keyframes dfModal {
          from { opacity: 0; transform: translate(-50%, -48%) scale(0.95); }
          to   { opacity: 1; transform: translate(-50%, -50%) scale(1);   }
        }
        @keyframes dfBackdrop {
          from { opacity: 0; }
          to   { opacity: 1; }
        }
      `}</style>
    </>
  );
}
